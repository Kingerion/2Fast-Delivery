<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2196f3">
    
    <title>2Fast Delivery (Debug Mode)</title>
    
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #f8f9fa; -webkit-tap-highlight-color: transparent; }
        
        /* Î§Î¬ÏÏ„Î·Ï‚ */
        #map { height: 38vh; min-height: 250px; width: 100%; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; background: #e0e0e0; position: relative; }
        
        /* ÎœÎ®Î½Ï…Î¼Î± Î±Î½ Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ½ÎµÎ¹ Î¿ Ï‡Î¬ÏÏ„Î·Ï‚ */
        #map-error {
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; color: #d32f2f; padding: 20px; font-weight: bold; width: 80%;
        }

        .container { 
            padding: 20px; max-width: 600px; margin: 0 auto; position: relative; top: -15px; z-index: 999; padding-bottom: 80px; 
        }

        h2 { margin-top: 10px; color: #333; text-align: center; font-size: 22px; font-weight: 800; margin-bottom: 20px; }
        
        .section-card { background: #fff; border-radius: 16px; padding: 16px; margin-bottom: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
        .section-title { font-size: 13px; font-weight: 800; color: #2196f3; margin-bottom: 12px; display: flex; align-items: center; }
        .section-title span { margin-right: 8px; font-size: 18px; }

        .input-group { margin-bottom: 12px; }
        label { font-size: 12px; font-weight: 600; color: #666; margin-bottom: 6px; display: block; }
        
        input, textarea, select { width: 100%; padding: 14px; border: 1px solid #eee; border-radius: 12px; box-sizing: border-box; font-size: 16px; background: #fdfdfd; appearance: none; }
        
        .row { display: flex; gap: 10px; }
        .col-6 { flex: 1; } .col-8 { flex: 0.8; } .col-4 { flex: 0.4; }

        .time-btn { flex: 1; padding: 14px; border: 1px solid #eee; background: #fff; border-radius: 12px; font-weight: 600; cursor: pointer; }
        .time-btn.active { background: #e3f2fd; border-color: #2196f3; color: #1565c0; }

        .price-box { background: linear-gradient(135deg, #2196f3, #1976d2); color: white; padding: 20px; border-radius: 16px; text-align: center; margin: 25px 0; }
        .price-value { font-size: 32px; font-weight: 800; }

        button#sendBtn { width: 100%; padding: 18px; background: #ff5722; color: white; border: none; border-radius: 16px; font-size: 18px; font-weight: 800; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        
        .loader { display: none; border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid #fff; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .pac-container { z-index: 10000 !important; border-radius: 12px; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="map">
        <div id="map-error">âš ï¸ ÎŸ Î§Î¬ÏÏ„Î·Ï‚ Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ½ÎµÎ¹.<br>Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ API Key.</div>
    </div>

    <div class="container">
        <h2>Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î”Î­Î¼Î±Ï„Î¿Ï‚</h2>
        
        <div class="input-group">
            <label>Î¤Î¿ Î¤Î·Î»Î­Ï†Ï‰Î½ÏŒ ÏƒÎ±Ï‚</label>
            <input type="tel" id="phone" placeholder="69..." style="font-weight: bold; font-size: 18px;">
        </div>

        <div class="section-card">
            <div class="section-title"><span>ğŸ•’</span> Î§Î¡ÎŸÎÎŸÎ£</div>
            <div class="row">
                <button type="button" class="time-btn active" id="btnNow" onclick="setTimeMode('now')">âš¡ Î¤ÏÏÎ±</button>
                <button type="button" class="time-btn" id="btnLater" onclick="setTimeMode('later')">ğŸ“… Î¡Î±Î½Ï„ÎµÎ²Î¿Ï</button>
            </div>
            <div id="nowMsg" style="margin-top: 12px; font-size: 13px; color: #2e7d32; font-weight: 600; text-align: center;">ğŸš€ Î†Ï†Î¹Î¾Î· ÏƒÎµ 25-35'</div>
            <div id="laterInputs" style="display: none; margin-top: 12px;"><input type="datetime-local" id="scheduledTime"></div>
        </div>

        <div class="section-card">
            <div class="section-title"><span>ğŸ“</span> Î Î‘Î¡Î‘Î›Î‘Î’Î—</div>
            <div class="input-group"><input type="text" id="start" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚..." onblur="calcRoute()"></div>
            <div class="row">
                <div class="col-8"><input type="text" id="startName" placeholder="ÎŒÎ½Î¿Î¼Î±/ÎšÎ¿Ï…Î´Î¿ÏÎ½Î¹"></div>
                <div class="col-4"><input type="text" id="startFloor" placeholder="ÎŒÏÎ¿Ï†Î¿Ï‚"></div>
            </div>
        </div>

        <div class="section-card">
            <div class="section-title"><span>ğŸ</span> Î Î‘Î¡Î‘Î”ÎŸÎ£Î—</div>
            <div class="input-group"><input type="text" id="end" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚..." onblur="calcRoute()"></div>
            <div class="row">
                <div class="col-8"><input type="text" id="endName" placeholder="ÎŒÎ½Î¿Î¼Î±/ÎšÎ¿Ï…Î´Î¿ÏÎ½Î¹"></div>
                <div class="col-4"><input type="text" id="endFloor" placeholder="ÎŒÏÎ¿Ï†Î¿Ï‚"></div>
            </div>
            <div class="input-group"><label>Î¤Î·Î»Î­Ï†Ï‰Î½Î¿ Î Î±ÏÎ±Î»Î®Ï€Ï„Î·</label><input type="tel" id="endPhone" placeholder="Î Î¿Î¹Î¿Î½ ÎºÎ±Î»Î¿ÏÎ¼Îµ;"></div>
        </div>

        <div class="section-card">
            <div class="section-title"><span>ğŸ“¦</span> Î›Î•Î Î¤ÎŸÎœÎ•Î¡Î•Î™Î•Î£</div>
            <div class="row">
                <div class="col-6"><label>Î”Î­Î¼Î±</label><select id="parcelType"><option>Î¦Î¬ÎºÎµÎ»Î¿Ï‚</option><option>ÎœÎ¹ÎºÏÏŒ</option><option>ÎœÎµÎ³Î¬Î»Î¿</option></select></div>
                <div class="col-6"><label>Î Î»Î·ÏÏ‰Î¼Î®</label><select id="paymentMethod"><option>ÎœÎµÏ„ÏÎ·Ï„Î¬</option><option>POS</option><option>Iris</option></select></div>
            </div>
        </div>

        <div class="input-group"><textarea id="comments" placeholder="Î£Ï‡ÏŒÎ»Î¹Î±..."></textarea></div>

        <div class="price-box">
            <div class="price-value" id="priceDisplay">0.00 â‚¬</div>
            <div style="font-size:14px" id="distDisplay">-</div>
        </div>

        <button id="sendBtn" onclick="sendOrder()">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</button>
    </div>

    <script>
        var map, directionsService, directionsRenderer, startAutocomplete, endAutocomplete;
        var calculatedPrice = 0, distanceText = "", timeMode = 'now';
        const MY_PHONE = "306934021792"; 
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz_XXXXXXXXXXXX/exec"; 

        // ğŸš¨ Î•Î™Î”Î™ÎšÎ— Î£Î¥ÎÎ‘Î¡Î¤Î—Î£Î— Î“Î™Î‘ Î•ÎÎ¤ÎŸÎ Î™Î£ÎœÎŸ Î›Î‘Î˜Î©Î GOOGLE ğŸš¨
        window.gm_authFailure = function() {
            document.getElementById('map-error').style.display = 'block';
            alert("âš ï¸ Î£Î¦Î‘Î›ÎœÎ‘ GOOGLE MAPS!\n\nÎ— Google Î±Ï€Î­ÏÏÎ¹ÏˆÎµ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯.\nÎ Î¹Î¸Î±Î½Î­Ï‚ Î±Î¹Ï„Î¯ÎµÏ‚:\n1. Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÎ½ÎµÏÎ³Î® ÎºÎ¬ÏÏ„Î± ÏƒÏ„Î¿ Billing (Î§ÏÎ­Ï‰ÏƒÎ·).\n2. Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Î´ÎµÎ½ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¿ '2fastdelivery.gr'.\n\nÎ Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿ Google Cloud Console.");
        };

        function initMap() {
            try {
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 13, center: { lat: 37.9429, lng: 23.6470 },
                    mapTypeControl: false, streetViewControl: false, fullscreenControl: false
                });
                directionsService = new google.maps.DirectionsService();
                directionsRenderer = new google.maps.DirectionsRenderer();
                directionsRenderer.setMap(map);
                initAutocomplete();
            } catch (e) { console.error(e); }
        }

        function initAutocomplete() {
            var options = { componentRestrictions: { country: "gr" }, fields: ["formatted_address", "geometry"], strictBounds: false };
            startAutocomplete = new google.maps.places.Autocomplete(document.getElementById('start'), options);
            endAutocomplete = new google.maps.places.Autocomplete(document.getElementById('end'), options);
            startAutocomplete.addListener("place_changed", calcRoute);
            endAutocomplete.addListener("place_changed", calcRoute);
        }

        function setTimeMode(mode) {
            timeMode = mode;
            document.getElementById('btnNow').className = mode==='now'?'time-btn active':'time-btn';
            document.getElementById('btnLater').className = mode==='later'?'time-btn active':'time-btn';
            document.getElementById('nowMsg').style.display = mode==='now'?'block':'none';
            document.getElementById('laterInputs').style.display = mode==='later'?'block':'none';
        }

        function calcRoute() {
            var startVal = document.getElementById('start').value;
            var endVal = document.getElementById('end').value;
            if (startVal && endVal) {
                directionsService.route({
                    origin: startVal, destination: endVal, travelMode: 'DRIVING'
                }, function(result, status) {
                    if (status == 'OK') {
                        directionsRenderer.setDirections(result);
                        var km = result.routes[0].legs[0].distance.value / 1000;
                        distanceText = result.routes[0].legs[0].distance.text;
                        
                        // Price Logic
                        var price = 3.00;
                        if (km > 1) {
                            var rem = km - 1;
                            if (rem <= 3) price += rem * 0.50;
                            else { price += 1.50; rem -= 3; var rate=0.60; while(rem>0){ price+= (rem>=1?1:rem)*rate; rem--; rate+=0.10; } }
                        }
                        calculatedPrice = price;
                        document.getElementById('priceDisplay').innerText = price.toFixed(2) + " â‚¬";
                        document.getElementById('distDisplay').innerText = distanceText;
                    } else {
                        // Î‘Î½ Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹ Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î®, ÎµÎ½Î·Î¼ÎµÏÏÎ½Î¿Ï…Î¼Îµ Î³Î¹Î±Ï„Î¯
                        alert("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î´Î¹Î±Î´ÏÎ¿Î¼Î®. Error: " + status);
                    }
                });
            }
        }

        function sendOrder() {
            var phone = document.getElementById('phone').value;
            if (!phone) { alert("Î’Î¬Î»Îµ Ï„Î·Î»Î­Ï†Ï‰Î½Î¿!"); return; }
            if (calculatedPrice == 0) { alert("Î¥Ï€Î¿Î»ÏŒÎ³Î¹ÏƒÎµ Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï€ÏÏÏ„Î±!"); calcRoute(); return; }
            
            // ... (ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚ Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ Î¯Î´Î¹Î¿Ï‚) ...
            alert("Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÎµÏƒÏ„Î¬Î»Î· (Demo)!");
        }
    </script>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkk3z2W3H172JxqlF4G0FjwppTDHJeXiw&libraries=places&callback=initMap" async defer></script>

</body>
</html>
