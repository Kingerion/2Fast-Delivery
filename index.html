<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2Fast Delivery - Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬Ï‚</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
        }
        /* Header - Î•Ï€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· */
        header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 40px 20px;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        header h1 { margin: 0; font-size: 2.5em; }
        header p { font-size: 1.2em; margin-top: 10px; opacity: 0.9; }

        .container {
            max-width: 800px;
            margin: -30px auto 20px; /* Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ header */
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
        }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #555; }
        input, textarea {
            width: 100%; padding: 12px; border: 1px solid #ddd;
            border-radius: 8px; font-size: 16px; box-sizing: border-box;
            background-color: #f9f9f9;
        }
        input:focus, textarea:focus { border-color: #007bff; outline: none; background-color: #fff; }

        /* ÎšÎ¿Ï…Î¼Ï€Î¯ Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï */
        .btn-calc {
            width: 100%; padding: 15px; background-color: #28a745;
            color: white; border: none; border-radius: 8px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            transition: transform 0.2s;
        }
        .btn-calc:active { transform: scale(0.98); }

        /* Î‘Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± & Î¦ÏŒÏÎ¼Î± Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚ */
        #result-area { display: none; margin-top: 30px; border-top: 2px dashed #ddd; padding-top: 20px; }
        
        .price-box {
            background: #e3f2fd; color: #0d47a1; padding: 15px;
            border-radius: 8px; text-align: center; margin-bottom: 20px;
            font-size: 1.2em; border: 1px solid #bbdefb;
        }

        /* ÎšÎ¿Ï…Î¼Ï€Î¯ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚ */
        .btn-send {
            width: 100%; padding: 15px; background-color: #007bff;
            color: white; border: none; border-radius: 8px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            margin-top: 10px;
        }
        .btn-send:hover { background-color: #0069d9; }

        #map { height: 350px; width: 100%; border-radius: 10px; margin-bottom: 20px; }
        
        .footer { text-align: center; padding: 20px; color: #777; font-size: 0.9em; }
    </style>
</head>
<body>

<header>
    <h1>2Fast Delivery</h1>
    <p>Î•ÏƒÎµÎ¯Ï‚ Ï€Î±ÏÎ±Î³Î³Î­Î»Î½ÎµÏ„Îµ, ÎµÎ¼ÎµÎ¯Ï‚ Ï„Î¿ Ï†Î­ÏÎ½Î¿Ï…Î¼Îµ!</p>
    <small>Î— ÎµÏ€Î¹Î¸Ï…Î¼Î¯Î± ÏƒÎ±Ï‚, Î´Î¹Î±Ï„Î±Î³Î® Î¼Î±Ï‚.</small>
</header>

<div class="container">
    <h3>ğŸ“ Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î”Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚</h3>
    <div class="input-group">
        <label>Î‘Ï€ÏŒ Ï€Î¿Ï Ï€Î±ÏÎ±Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î¼Îµ;</label>
        <input type="text" id="start" placeholder="Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î® Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï€Î±ÏÎ±Î»Î±Î²Î®Ï‚">
    </div>
    
    <div class="input-group">
        <label>Î Î¿Ï Ï€Î±ÏÎ±Î´Î¯Î´Î¿Ï…Î¼Îµ;</label>
        <input type="text" id="end" placeholder="Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· Î® Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï€Î±ÏÎ¬Î´Î¿ÏƒÎ·Ï‚">
    </div>
    
    <button class="btn-calc" onclick="calculate()">ğŸ” Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎšÏŒÏƒÏ„Î¿Ï…Ï‚</button>

    <div id="result-area">
        <div id="map"></div>
        <div id="price-display" class="price-box"></div>

        <h3>ğŸ“¦ Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</h3>
        <div class="input-group">
            <label>Î¤Î¿ Î¤Î·Î»Î­Ï†Ï‰Î½ÏŒ ÏƒÎ±Ï‚ (Î‘Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿):</label>
            <input type="tel" id="phone" placeholder="Ï€.Ï‡. 6900000000">
        </div>

        <div class="input-group">
            <label>ÎŒÏÎ¿Ï†Î¿Ï‚ / ÎšÎ¿Ï…Î´Î¿ÏÎ½Î¹:</label>
            <input type="text" id="floor" placeholder="Ï€.Ï‡. 2Î¿Ï‚ ÏŒÏÎ¿Ï†Î¿Ï‚, Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚">
        </div>

        <div class="input-group">
            <label>Î£Ï‡ÏŒÎ»Î¹Î± / ÎŸÎ´Î·Î³Î¯ÎµÏ‚:</label>
            <textarea id="comments" rows="3" placeholder="Ï€.Ï‡. Î ÏÎ¿ÏƒÎ¿Ï‡Î® ÏƒÏ„Î¿ ÏƒÎºÏÎ»Î¿, Ï‡Ï„Ï…Ï€Î®ÏƒÏ„Îµ Î´Ï…Î½Î±Ï„Î¬..."></textarea>
        </div>

        <button class="btn-send" onclick="sendOrder()">ğŸš€ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</button>
    </div>
</div>

<div class="footer">Â© 2024 2Fast Delivery Services</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // --- Î¡Î¥Î˜ÎœÎ™Î£Î•Î™Î£ ADMIN ---
    // Î•Î”Î© Î“Î¡Î‘Î¦Î•Î™Î£ Î¤ÎŸ ÎšÎ™ÎÎ—Î¤ÎŸ Î£ÎŸÎ¥ (Admin)
    // Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Ï„Î¿ 30 Î¼Ï€ÏÎ¿ÏƒÏ„Î¬. Î .Ï‡. "306912345678"
    const ADMIN_PHONE = "306934021792"; 
    // -----------------------

    var map = L.map('map').setView([37.9838, 23.7275], 10);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'OpenStreetMap'
    }).addTo(map);

    var routeLine;
    var markers = [];
    var currentPrice = 0;
    var currentDistance = 0;

    async function calculate() {
        const startAddr = document.getElementById('start').value;
        const endAddr = document.getElementById('end').value;

        if (!startAddr || !endAddr) {
            alert("Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î¹Ï‚ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚!");
            return;
        }

        try {
            // Geocoding
            const startRes = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(startAddr)}`);
            const startData = await startRes.json();
            const endRes = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(endAddr)}`);
            const endData = await endRes.json();

            if (startData.length === 0 || endData.length === 0) throw new Error("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·.");

            const p1 = [startData[0].lat, startData[0].lon];
            const p2 = [endData[0].lat, endData[0].lon];

            // Routing
            const routeRes = await fetch(`https://router.project-osrm.org/route/v1/driving/${p1[1]},${p1[0]};${p2[1]},${p2[0]}?overview=full&geometries=geojson`);
            const routeData = await routeRes.json();
            
            if (routeData.code !== "Ok") throw new Error("Î‘Î´Ï…Î½Î±Î¼Î¯Î± ÎµÏÏÎµÏƒÎ·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚.");

            const distanceMeters = routeData.routes[0].distance;
            currentDistance = distanceMeters / 1000;

            // Î¤Î¹Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·
            currentPrice = 2.50;
            if (currentDistance > 0.5) {
                currentPrice = 2.50 + ((currentDistance - 0.5) * 0.50);
            }

            // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ·
            document.getElementById('result-area').style.display = 'block';
            document.getElementById('price-display').innerHTML = `
                <strong>Î‘Ï€ÏŒÏƒÏ„Î±ÏƒÎ·:</strong> ${currentDistance.toFixed(2)} Ï‡Î»Î¼<br>
                <strong style="font-size:1.4em">ÎšÏŒÏƒÏ„Î¿Ï‚: ${currentPrice.toFixed(2)}â‚¬</strong>
            `;

            // Î§Î¬ÏÏ„Î·Ï‚
            if (routeLine) map.removeLayer(routeLine);
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            markers.push(L.marker(p1).addTo(map).bindPopup("Î‘Ï†ÎµÏ„Î·ÏÎ¯Î±"));
            markers.push(L.marker(p2).addTo(map).bindPopup("Î ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚"));
            
            routeLine = L.geoJSON(routeData.routes[0].geometry, { style: { color: '#007bff', weight: 5 } }).addTo(map);
            map.fitBounds(routeLine.getBounds());

        } catch (e) {
            alert("Î£Ï†Î¬Î»Î¼Î±: " + e.message);
        }
    }
function sendOrder() {
        const phone = document.getElementById('phone').value;
        const floor = document.getElementById('floor').value;
        const comments = document.getElementById('comments').value;
        const start = document.getElementById('start').value;
        const end = document.getElementById('end').value;
        const submitBtn = document.querySelector('.btn-send');

        if (!phone) {
            alert("Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î¿ Ï„Î·Î»Î­Ï†Ï‰Î½ÏŒ ÏƒÎ±Ï‚!");
            return;
        }

        // 1. ÎšÎ»ÎµÎ¯Î´Ï‰Î¼Î± ÎºÎ¿Ï…Î¼Ï€Î¹Î¿Ï ÎºÎ±Î¹ Î­Î½Î´ÎµÎ¹Î¾Î· Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚
        submitBtn.innerHTML = "â³ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...";
        submitBtn.disabled = true;

        // 2. Î•Ï„Î¿Î¹Î¼Î±ÏƒÎ¯Î± Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
        const orderData = {
            phone: phone,
            start: start,
            end: end,
            floor: floor,
            comments: comments,
            distance: currentDistance.toFixed(2),
            price: currentPrice.toFixed(2)
        };

        // --------------------------------------------------------------------
        // Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î’Î¬Î»Îµ ÎµÎ´Ï Ï„Î¿ Link Î±Ï€ÏŒ Ï„Î¿ Google Script Ï€Î¿Ï… Î­Ï†Ï„Î¹Î±Î¾ÎµÏ‚ Î³Î¹Î± Ï„Î¿ Shipday
        const scriptURL = "https://script.google.com/macros/s/AKfycbxlzPr-MGJxdf0xVabdHI9ZgHOANz9dym7veDFn7CQvf557pUIDq9nc7qihmCa4H2jh/exec"; 
        // --------------------------------------------------------------------

        // 3. Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÏƒÏ„Î¿ Shipday (ÎºÎ±Î¹ Î±Î½Î±Î¼Î¿Î½Î®)
        fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors', 
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(orderData)
        })
        .then(() => {
            console.log("Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ ÏƒÏ„Î¿ Shipday!");
            // 4. ÎœÎŸÎÎŸ Î‘Î¦ÎŸÎ¥ Ï„ÎµÎ»ÎµÎ¹ÏÏƒÎµÎ¹ Î· Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®, Î±Î½Î¿Î¯Î³Î¿Ï…Î¼Îµ Ï„Î¿ WhatsApp
            openWhatsApp(phone, start, end, floor, comments);
        })
        .catch(error => {
            console.error('Î£Ï†Î¬Î»Î¼Î±:', error);
            alert("Î¥Ï€Î®ÏÎ¾Îµ Î­Î½Î± Î¸Î­Î¼Î± Î¼Îµ Ï„Î·Î½ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·, Î±Î»Î»Î¬ Î±Î½Î¿Î¯Î³Î¿Ï…Î¼Îµ Ï„Î¿ WhatsApp.");
            // Î‘Î½Î¿Î¯Î³Î¿Ï…Î¼Îµ Ï„Î¿ WhatsApp Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹, Î³Î¹Î± Î½Î± Î¼Î·Î½ Ï‡Î¬ÏƒÎµÎ¹Ï‚ Ï„Î·Î½ Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±
            openWhatsApp(phone, start, end, floor, comments);
        })
        .finally(() => {
            // Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ ÎºÎ¿Ï…Î¼Ï€Î¹Î¿Ï
            submitBtn.innerHTML = "ğŸš€ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚";
            submitBtn.disabled = false;
        });
    }

    // Î’Î¿Î·Î¸Î·Ï„Î¹ÎºÎ® ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î³Î¹Î± Ï„Î¿ Î¬Î½Î¿Î¹Î³Î¼Î± Ï„Î¿Ï… WhatsApp
    function openWhatsApp(phone, start, end, floor, comments) {
        const text = `ğŸš€ *ÎÎ•Î‘ Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘* ğŸš€%0A%0A` +
                     `ğŸ“ *Î‘Ï€ÏŒ:* ${encodeURIComponent(start)}%0A` +
                     `ğŸ *Î ÏÎ¿Ï‚:* ${encodeURIComponent(end)}%0A` +
                     `ğŸ“ *Î‘Ï€ÏŒÏƒÏ„Î±ÏƒÎ·:* ${currentDistance.toFixed(2)} Ï‡Î»Î¼%0A` +
                     `ğŸ’° *Î¤Î¹Î¼Î®:* ${currentPrice.toFixed(2)}â‚¬%0A` +
                     `-----------------------%0A` +
                     `ğŸ“ *Î ÎµÎ»Î¬Ï„Î·Ï‚:* ${phone}%0A` +
                     `ğŸ¢ *ÎŒÏÎ¿Ï†Î¿Ï‚:* ${encodeURIComponent(floor)}%0A` +
                     `ğŸ“ *Î£Ï‡ÏŒÎ»Î¹Î±:* ${encodeURIComponent(comments)}`;
        
        window.location.href = `https://wa.me/${ADMIN_PHONE}?text=${text}`;
    }

</script>

</body>
</html>
