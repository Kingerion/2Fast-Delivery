<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1E293B">
    <title>2Fast Delivery | Online Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±</title>
    <style>
        :root { --primary: #FF5722; --secondary: #1E293B; --bg: #F1F5F9; --card: #FFFFFF; --text: #334155; --border: #E2E8F0; }
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; min-height: 100vh; }
        
        .install-banner { background: var(--primary); color: white; padding: 12px 15px; font-size: 13px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .install-text { flex: 1; line-height: 1.4; }
        .install-close { background: none; border: none; color: white; font-size: 22px; font-weight: bold; cursor: pointer; padding-left: 10px; }
        
        .header { display: flex; justify-content: center; align-items: center; background: var(--secondary); color: white; padding: 15px; font-size: 22px; font-weight: 900; letter-spacing: 1px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 10; position: relative; }
        
        .action-row { display: flex; justify-content: flex-end; gap: 10px; padding: 15px 20px 5px 20px; }
        .action-btn { display: flex; align-items: center; gap: 6px; padding: 10px 15px; border-radius: 10px; text-decoration: none; font-weight: 700; font-size: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); font-family: inherit; }
        .btn-profile { background: var(--card); color: var(--secondary); border: 1.5px solid var(--border); }
        .btn-support { background: #25D366; color: white; border: none; cursor: pointer; position: relative; }
        
        .support-menu { display: none; position: absolute; top: 100%; right: 0; margin-top: 8px; background: var(--card); border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); border: 1px solid var(--border); z-index: 100; min-width: 180px; overflow: hidden; }
        .support-menu.active { display: flex; flex-direction: column; }
        .support-item { padding: 12px 15px; text-decoration: none; color: var(--text); font-weight: 700; font-size: 13px; border-bottom: 1px solid var(--border); text-align: left; }
        .support-item:last-child { border-bottom: none; }

        .container { flex: 1; padding: 0 20px 30px 20px; max-width: 600px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .card { background: var(--card); padding: 22px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.02); }
        .title { color: var(--secondary); font-weight: 800; font-size: 13px; text-transform: uppercase; margin-bottom: 18px; display: flex; align-items: center; border-bottom: 2px solid var(--border); padding-bottom: 10px; }
        .title span.req { color: red; font-size: 16px; margin-left: 5px; }
        
        .input-group { margin-bottom: 16px; }
        .flex-row { display: flex; gap: 12px; margin-bottom: 16px; }
        .flex-row > * { flex: 1; }
        input, select, textarea { width: 100%; padding: 14px; border: 2px solid var(--border); border-radius: 10px; font-size: 15px; box-sizing: border-box; background: #F8FAFC; transition: 0.3s; color: var(--text); font-family: inherit; }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); background: #fff; outline: none; }
        
        .price-box { background: var(--secondary); color: white; text-align: center; padding: 20px; border-radius: 12px; margin-top: 20px; box-shadow: 0 4px 15px rgba(30,41,59,0.2); }
        .price-amount { font-size: 36px; font-weight: 900; color: white; margin: 5px 0; }
        .price-details { font-size: 13px; color: #94A3B8; }
        
        .btn-submit { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 800; cursor: pointer; transition: 0.2s; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 10px; box-shadow: 0 4px 15px rgba(255,87,34,0.3); }
        .btn-submit:active { transform: scale(0.98); }
        .btn-submit:disabled { background: #cbd5e1; box-shadow: none; cursor: not-allowed; }

        .footer { background: var(--secondary); color: white; padding: 30px 20px; margin-top: auto; border-top-left-radius: 20px; border-top-right-radius: 20px; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; max-width: 800px; margin: 0 auto; }
        .footer-col h4 { color: var(--primary); font-size: 14px; text-transform: uppercase; margin-bottom: 12px; font-weight: 800; letter-spacing: 0.5px; }
        .footer-col p, .footer-col ul { font-size: 13px; color: #cbd5e1; line-height: 1.6; margin: 0; padding: 0; list-style: none; }
        .footer-col ul li { margin-bottom: 8px; display: flex; align-items: flex-start; gap: 6px; }
    </style>
</head>
<body>
    <div class="install-banner" id="installBanner" style="display: none;">
        <div class="install-text"><strong>ğŸ“² Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚</strong><br>Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î·Î½ Î‘ÏÏ‡Î¹ÎºÎ® ÎŸÎ¸ÏŒÎ½Î· Î³Î¹Î± Î¬Î¼ÎµÏƒÎ· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·.</div>
        <button class="install-close" onclick="this.parentElement.style.display='none'">Ã—</button>
    </div>

    <header class="header">ğŸš€ 2FAST DELIVERY</header>
    <div id="map" style="height: 40vh; width: 100%; position: relative;"></div>

    <div class="action-row">
        <div style="position: relative;">
            <button onclick="document.getElementById('supportMenu').classList.toggle('active')" class="action-btn btn-support">ğŸ§ Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·</button>
            <div class="support-menu" id="supportMenu">
                <a href="https://wa.me/306934021792" class="support-item" target="_blank">ğŸŸ¢ WhatsApp Support</a>
                <a href="mailto:2fastdelivery1@gmail.com" class="support-item" style="color: #3b82f6;">âœ‰ï¸ Email Support</a>
            </div>
        </div>
        <a href="profile.html" class="action-btn btn-profile">ğŸ‘¤ Î ÏÎ¿Ï†Î¯Î»</a>
    </div>

    <div class="container">
        <div class="card" style="margin-top: -10px; position: relative; z-index: 10;">
            <div class="title">ğŸ“ Î£Î·Î¼ÎµÎ¯Î± Î”Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ <span class="req">*</span></div>
            <div class="input-group"><input type="text" id="start" placeholder="Î‘Ï€ÏŒ: ÎŸÎ´ÏŒÏ‚ Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚, Î ÎµÏÎ¹Î¿Ï‡Î®" required></div>
            <div class="input-group"><input type="text" id="end" placeholder="Î ÏÎ¿Ï‚: ÎŸÎ´ÏŒÏ‚ Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚, Î ÎµÏÎ¹Î¿Ï‡Î®" required></div>
            <div class="price-box">
                <div style="font-size: 12px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; color: #cbd5e1;">ÎšÎ¿ÏƒÏ„Î¿Ï‚ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î·Ï‚</div>
                <div class="price-amount" id="price">0.00 â‚¬</div>
                <div class="price-details" id="distance">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿ Ï‡Î¬ÏÏ„Î·</div>
            </div>
        </div>

        <div class="card">
            <div class="title">ğŸ“¦ Î£Î¤ÎŸÎ™Î§Î•Î™Î‘ Î Î‘Î¡Î‘Î›Î‘Î’Î—Î£ <span class="req">*</span></div>
            <div class="input-group"><input type="text" id="pickupName" placeholder="ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿ / Î•Ï„Î±Î¹ÏÎµÎ¯Î±" required></div>
            <div class="flex-row">
                <input type="tel" id="pickupPhone" placeholder="Î¤Î·Î»Î­Ï†Ï‰Î½Î¿" required>
                <input type="text" id="pickupTime" placeholder="ÎÏÎ± (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)">
            </div>
        </div>

        <div class="card">
            <div class="title">ğŸ  Î£Î¤ÎŸÎ™Î§Î•Î™Î‘ Î Î‘Î¡Î‘Î”ÎŸÎ£Î—Î£ <span class="req">*</span></div>
            <div class="input-group"><input type="text" id="deliveryName" placeholder="ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿ Î Î±ÏÎ±Î»Î®Ï€Ï„Î·" required></div>
            <div class="input-group"><input type="tel" id="deliveryPhone" placeholder="Î¤Î·Î»Î­Ï†Ï‰Î½Î¿ Î Î±ÏÎ±Î»Î®Ï€Ï„Î·" required></div>
            <div class="flex-row">
                <input type="text" id="deliveryDate" placeholder="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±" onfocus="(this.type='date')" onblur="(this.type='text')">
                <input type="text" id="deliveryTime" placeholder="ÎÏÎ± (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)">
            </div>
            <div class="input-group">
                <label style="font-size: 12px; font-weight: bold; color: var(--secondary); margin-bottom: 5px; display: block;">Î£Î§ÎŸÎ›Î™Î‘ Î Î‘Î¡Î‘Î”ÎŸÎ£Î—Î£ <span class="req">*</span></label>
                <textarea id="deliveryNote" rows="3" required>ÎŒÏÎ¿Ï†Î¿Ï‚ : 
ÎšÎ¿Ï…Î´Î¿ÏÎ½Î¹ : </textarea>
            </div>
            <div class="input-group">
                <select id="paymentMethod" required>
                    <option value="" disabled selected>-- Î¤ÏÏŒÏ€Î¿Ï‚ Î Î»Î·ÏÏ‰Î¼Î®Ï‚ --</option>
                    <option value="ÎœÎµÏ„ÏÎ·Ï„Î¬">ğŸ’µ ÎœÎµÏ„ÏÎ·Ï„Î¬</option>
                    <option value="ÎšÎ¬ÏÏ„Î± (POS)">ğŸ’³ ÎšÎ¬ÏÏ„Î± (POS)</option>
                </select>
            </div>
        </div>
        <button class="btn-submit" id="sendBtn" onclick="submitOrder()">ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î£Î— Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘Î£</button>
    </div>

    <footer class="footer">
        <div class="footer-grid">
            <div class="footer-col">
                <h4>Î£Î§Î•Î¤Î™ÎšÎ‘ ÎœÎ• Î•ÎœÎ‘Î£</h4>
                <p>Î— <strong>2Fast Delivery</strong> Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Î¬Î¼ÎµÏƒÎµÏ‚ Î»ÏÏƒÎµÎ¹Ï‚ Ï„Î±Ï‡Ï…Î¼ÎµÏ„Î±Ï†Î¿ÏÏÎ½ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÏƒÎ±Ï‚ Î±Î½Î¬Î³ÎºÎ·.</p>
            </div>
            <div class="footer-col">
                <h4>Î•Î Î™ÎšÎŸÎ™ÎÎ©ÎÎ™Î‘</h4>
                <ul>
                    <li>ğŸ“ 6934021792</li>
                    <li>âœ‰ï¸ 2fastdelivery1@gmail.com</li>
                    <li>ğŸ•’ Î”ÎµÏ…Ï„Î­ÏÎ± - Î£Î¬Î²Î²Î±Ï„Î¿</li>
                </ul>
            </div>
        </div>
    </footer>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwc8G9tP4w-R58r5_O2zR9N9bX4K4dF1l_Z5uX3P_l2zS2QYfXp0X7K8D5J2Wk/exec';
        let map, directionsService, directionsRenderer, calculatedPrice = 0;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), { center: {lat: 37.9429, lng: 23.6439}, zoom: 12, disableDefaultUI: true });
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer({ map: map, polylineOptions: { strokeColor: '#FF5722', strokeWeight: 5 } });
            const sA = new google.maps.places.Autocomplete(document.getElementById('start'));
            const eA = new google.maps.places.Autocomplete(document.getElementById('end'));
            sA.addListener('place_changed', calc); eA.addListener('place_changed', calc);
        }

        function calc() {
            const s = document.getElementById('start').value, e = document.getElementById('end').value;
            if (!s || !e) return;
            directionsService.route({ origin: s, destination: e, travelMode: 'DRIVING' }, (res, status) => {
                if (status === 'OK') {
                    directionsRenderer.setDirections(res);
                    const d = res.routes[0].legs[0].distance.value / 1000;
                    let p = 3.50; if (d > 2) p += (d - 2) * 0.70;
                    calculatedPrice = p.toFixed(2);
                    document.getElementById('price').innerText = calculatedPrice + ' â‚¬';
                    document.getElementById('distance').innerText = d.toFixed(1) + ' Ï‡Î»Î¼ - ~' + Math.round(res.routes[0].legs[0].duration.value / 60) + ' Î»ÎµÏ€Ï„Î¬';
                }
            });
        }

                function submitOrder() {
            if (calculatedPrice == 0) return alert("ğŸ“ Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ Ï€Î±ÏÎ±Î»Î±Î²Î®Ï‚ ÎºÎ±Î¹ Ï€Î±ÏÎ¬Î´Î¿ÏƒÎ·Ï‚!");
            
            const btn = document.getElementById('sendBtn');
            btn.innerText = "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®... â³"; 
            btn.disabled = true;

            const payload = {
                startAddr: document.getElementById('start').value, 
                endAddr: document.getElementById('end').value,
                price: calculatedPrice, 
                pickupName: document.getElementById('pickupName').value, 
                pickupPhone: document.getElementById('pickupPhone').value,
                pickupTime: document.getElementById('pickupTime').value, 
                deliveryName: document.getElementById('deliveryName').value,
                deliveryPhone: document.getElementById('deliveryPhone').value, 
                deliveryDate: document.getElementById('deliveryDate').value,
                deliveryTime: document.getElementById('deliveryTime').value, 
                notes: "Î Î›Î—Î¡Î©ÎœÎ—: " + document.getElementById('paymentMethod').value + " | " + document.getElementById('deliveryNote').value
            };

            // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Ï€ÏÎ¿Ï†Î¯Î» Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·
            if (window.saveDeliveryData) {
                window.saveDeliveryData(payload.deliveryName, payload.deliveryPhone, payload.endAddr, payload.notes, calculatedPrice);
            }

            // Î— ÏƒÏ‰ÏƒÏ„Î® Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Ï€Î¿Ï… Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Shipday
            fetch(SCRIPT_URL, { 
                method: 'POST', 
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify(payload) 
            })
            .then(response => response.text())
            .then(data => { 
                alert("âœ… Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î± ÏƒÏ„Î¿ Shipday!"); 
                window.location.reload(); 
            })
            .catch(error => { 
                alert("âš ï¸ Î ÏÏŒÎ²Î»Î·Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚. Î Î±ÏÎ±ÎºÎ±Î»Ï Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Î¾Î±Î½Î¬!"); 
                btn.disabled = false; 
                btn.innerText = "ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î£Î— Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘Î£"; 
            });
        }

    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAdeWVPf1-3ZObret2Onsjb6_DldLgaQCw&libraries=places&callback=initMap" async defer></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const app = initializeApp({ apiKey: "AIzaSyDHmXVo-2kFvCFN3Q8U_MvJl_By_b6hs2w", authDomain: "fast-delivery-8227d.firebaseapp.com", projectId: "fast-delivery-8227d", storageBucket: "fast-delivery-8227d.firebasestorage.app" });
        const auth = getAuth(app); const db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => {
            if (!user) { window.location.replace("login.html"); } 
            else {
                const docSnap = await getDoc(doc(db, "users", user.uid));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.isBlocked) { alert("â›” Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ ÎºÎ»ÎµÎ¹ÏƒÏ„ÏŒÏ‚."); signOut(auth).then(() => window.location.replace("login.html")); return; }
                    document.getElementById('deliveryName').value = data.name || "";
                    document.getElementById('deliveryPhone').value = data.phone || "";
                }
            }
        });

        window.saveDeliveryData = async function(n, p, a, nt, pr) {
            if (auth.currentUser) {
                const uid = auth.currentUser.uid;
                await setDoc(doc(db, "users", uid), { name: n, phone: p, address: a, notes: nt }, { merge: true });
                await addDoc(collection(db, "users", uid, "orders"), { price: pr + " â‚¬", destination: a, timestamp: new Date() });
            }
        };
    </script>

    <script type="text/javascript">window.$crisp=[];window.CRISP_WEBSITE_ID="67431364-9c28-4ce0-8c7b-7c0df05f0313";(function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();</script>
</body>
</html>